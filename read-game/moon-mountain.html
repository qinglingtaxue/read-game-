<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœˆäº®å±±æ¢ç´¢ä¹‹æ—…</title>
    <link rel="stylesheet" href="css/moon-mountain.css">
</head>
<body>
    <button class="back-btn" onclick="goBack()">â† è¿”å›é€‰æ‹©</button>

    <!-- è¿›åº¦æ˜¾ç¤º -->
    <div class="progress-display">
        <span class="mountain-progress">æœˆäº®å±±è¿›åº¦ï¼š<span id="mountain-progress">0/7</span></span>
        <span class="total-progress">æ€»è¿›åº¦ï¼š<span id="total-progress">0/420</span></span>
    </div>
    
    <div class="mountain-scene">
        <!-- äº‘æœµ -->
        <div class="cloud cloud1"></div>
        <div class="cloud cloud2"></div>
        
        <!-- å±±è„‰å±‚æ¬¡ -->
        <div class="distant-mountains"></div>
        <div class="middle-mountains"></div>
        <div class="front-mountains"></div>

        <!-- æœˆäº® -->
        <div class="moon">
            <div class="moon-crater crater1"></div>
            <div class="moon-crater crater2"></div>
            <div class="moon-crater crater3"></div>
        </div>
        
        <!-- æ˜Ÿç©ºèƒŒæ™¯ -->
        <div class="stars">
            <div class="star star1"></div>
            <div class="star star2"></div>
            <div class="star star3"></div>
            <div class="star star4"></div>
            <div class="star star5"></div>
            <div class="star star6"></div>
            <div class="star star7"></div>
        </div>

        <!-- å±±é¡¶çš„åˆ›æ–°è€…å­¦æ´¾ -->
        <div class="innovation-peak">
            <div class="peak-glow"></div>
            <div class="peak-name">åˆ›æ–°è€…å­¦æ´¾</div>
        </div>

        <!-- æœˆäº®å±±çš„æ™ºè€…ä»¬ -->
        <div class="sages-on-moon">
            <div class="sage-figure sage-bacon" data-sage="bacon" onclick="exploreSage('bacon')">
                <div class="sage-avatar">ğŸ“š</div>
                <div class="sage-name">åŸ¹æ ¹</div>
                <div class="sage-specialty">ç»éªŒä¸»ä¹‰</div>
            </div>
            
            <div class="sage-figure sage-descartes" data-sage="descartes" onclick="exploreSage('descartes')">
                <div class="sage-avatar">ğŸ¤”</div>
                <div class="sage-name">ç¬›å¡å°”</div>
                <div class="sage-specialty">ç†æ€§ä¸»ä¹‰</div>
            </div>
            
            <div class="sage-figure sage-hume" data-sage="hume" onclick="exploreSage('hume')">
                <div class="sage-avatar">ğŸ­</div>
                <div class="sage-name">ä¼‘è°Ÿ</div>
                <div class="sage-specialty">æ€€ç–‘ä¸»ä¹‰</div>
            </div>
            
            <div class="sage-figure sage-kant" data-sage="kant" onclick="exploreSage('kant')">
                <div class="sage-avatar">âš–ï¸</div>
                <div class="sage-name">åº·å¾·</div>
                <div class="sage-specialty">æ‰¹åˆ¤å“²å­¦</div>
            </div>
            
            <div class="sage-figure sage-husserl" data-sage="husserl" onclick="exploreSage('husserl')">
                <div class="sage-avatar">ğŸ‘ï¸</div>
                <div class="sage-name">èƒ¡å¡å°”</div>
                <div class="sage-specialty">ç°è±¡å­¦</div>
            </div>
            
            <div class="sage-figure sage-wittgenstein" data-sage="wittgenstein" onclick="exploreSage('wittgenstein')">
                <div class="sage-avatar">ğŸ—£ï¸</div>
                <div class="sage-name">ç»´ç‰¹æ ¹æ–¯å¦</div>
                <div class="sage-specialty">è¯­è¨€å“²å­¦</div>
            </div>
            
            <div class="sage-figure sage-polanyi" data-sage="polanyi" onclick="exploreSage('polanyi')">
                <div class="sage-avatar">ğŸ”¬</div>
                <div class="sage-name">æ³¢å…°å°¼</div>
                <div class="sage-specialty">éšæ€§çŸ¥è¯†</div>
            </div>
        </div>
        
        <!-- æ¢ç´¢æç¤º -->
        <div class="exploration-hint">
            ğŸŒŸ ç‚¹å‡»æœˆå…‰ä¸‹çš„æ™ºè€…å¼€å§‹å¯¹è¯
        </div>
        
        <!-- å¯¼æ¸¸äººç‰©å’Œå¯¹è¯æ°”æ³¡ - ç§»åˆ°å·¦ä¾§ -->
        <div class="guide-section">
            <div class="guide-character">
                <div class="guide-avatar">ğŸŒ™</div>
                <div class="guide-name">æœˆäº®å®ˆæŠ¤è€…</div>
            </div>
            <div class="speech-bubble">
                <div class="bubble-content">
                    <h3>ğŸŒ™ æœˆäº®ä¹‹å±±ï¼Œæˆ‘åœ¨ä»°æœ›</h3>
                    <p>æœˆäº®ä¹‹ä¸Šï¼Œæœ‰å¤šå°‘çŸ¥è¯†ï¼Œåœ¨è‡ªç”±çš„æ¼«æ­¥ã€‚é€šå¾€å±±ä¹‹å·…çš„è·¯å¾„æœ‰ä¸‰æ¡ï¼šç¬›å¡å°”ä¿¡å¾’å±±è„‰ã€è®²æ•…äº‹çš„äººå±±è„‰ã€è¾¾å°”æ–‡ä¿¡å¾’å±±è„‰ã€‚</p>
                    <p>åœ¨æ±²å–äº†å¤©åœ°é—´çš„ç²¾åä¹‹åï¼Œæœ‰ä¸€ä¸ªè€äººæ¥åˆ°å±±ä¹‹å·…ï¼Œå¼€åˆ›äº†åˆ›æ–°è€…å­¦æ´¾ã€‚</p>
                </div>
                <div class="bubble-tail"></div>
            </div>
        </div>
    </div>

    <!-- éŸ³ä¹æ§åˆ¶æŒ‰é’® -->
    <button class="music-toggle" id="musicBtn" onclick="toggleBgMusic()">ğŸµ</button>

    <!-- èƒŒæ™¯éŸ³ä¹ -->
    <audio id="bgMusic" loop>
        <source src="music/sun-mountain-bg.MP3" type="audio/mpeg">
        <source src="music/sun-mountain-bg.MP3" type="audio/ogg">
    </audio>

    <script>
        // è¿”å›å…¨æ™¯å›¾
        function goBack() {
            window.location.href = 'index.html';
        }

        // æ‹œè®¿æ™ºè€…
        function exploreSage(sageId) {
            window.location.href = `sages/moon/${sageId}.html`;
        }

        // æ£€æŸ¥å±±å³°å®ŒæˆçŠ¶æ€
        function checkMountainComplete() {
            const visitedSages = JSON.parse(localStorage.getItem('visitedSages') || '[]');
            const moonSages = ['bacon', 'descartes', 'hume', 'kant', 'husserl', 'wittgenstein', 'polanyi'];
            const completedCount = moonSages.filter(sage => visitedSages.includes(`moon-${sage}`)).length;
            
            document.getElementById('mountain-progress').textContent = `${completedCount}/7`;
            document.getElementById('total-progress').textContent = `${visitedSages.length}/420`;
            
            // æ›´æ–°æ™ºè€…çŠ¶æ€æ˜¾ç¤º
            moonSages.forEach(sage => {
                const sageElement = document.querySelector(`[data-sage="${sage}"]`);
                if (visitedSages.includes(`moon-${sage}`)) {
                    sageElement.classList.add('visited');
                }
            });
            
            // å¦‚æœå®Œæˆäº†æœˆäº®å±±ï¼Œæ˜¾ç¤ºå‰å¾€ä¸‹ä¸€åº§å±±çš„æç¤º
          if (completedCount === 7 && !localStorage.getItem('moonMountainCompleted')) {
    localStorage.setItem('moonMountainCompleted', 'true');
    showNextMountainOption();
}
        }

        // æ˜¾ç¤ºå‰å¾€ä¸‹ä¸€åº§å±±çš„é€‰é¡¹
        function showNextMountainOption() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.7); display: flex; justify-content: center; align-items: center; z-index: 2000;
            `;
            
            modal.innerHTML = `
                <div style="background: white; padding: 40px; border-radius: 20px; text-align: center; max-width: 500px; position: relative;">
                    <span onclick="this.parentElement.parentElement.remove()" 
                          style="position: absolute; top: 20px; right: 25px; cursor: pointer; font-size: 28px; color: #999; font-weight: bold; user-select: none;">&times;</span>
                    
                    <h3 style="color: #4169E1; margin-bottom: 25px; font-size: 24px;">ğŸ‰ æ­å–œå®Œæˆæœˆäº®å±±æ¢ç´¢ï¼</h3>
                    <p style="margin-bottom: 30px; font-size: 16px; line-height: 1.6; color: #333;">ä½ å·²æ‹œè®¿äº†æœˆäº®å±±çš„æ‰€æœ‰7ä½æ™ºè€…ï¼Œè·å¾—äº†æ–¹æ³•è®ºçš„æ™ºæ…§ã€‚ç°åœ¨å¯ä»¥å‰å¾€æ›´é«˜å±‚æ¬¡çš„æ™ºæ…§å±±å³°ã€‚</p>
                    
                    <div style="display: flex; gap: 20px; justify-content: center;">
                        <button onclick="goToNextMountain()" style="background: linear-gradient(45deg, #4169E1, #1E90FF); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-size: 16px; font-weight: bold;">æ¢ç´¢å¤©ä¹‹å±±</button>
                        <button onclick="goBack()" style="background: #666; color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-size: 16px;">è¿”å›å…¨æ™¯</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // å‰å¾€ä¸‹ä¸€åº§å±±
        function goToNextMountain() {
            window.location.href = 'index.html#heaven-mountains';
        }

        // èƒŒæ™¯éŸ³ä¹æ§åˆ¶
        const bgMusic = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicBtn');

        if (bgMusic) {
            bgMusic.volume = 0.3;
        }

        function toggleBgMusic() {
            if (!bgMusic) return;
            
            if (bgMusic.paused) {
                bgMusic.play().then(() => {
                    musicBtn.textContent = 'ğŸ”Š';
                }).catch(error => {
                    console.log('æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥éŸ³é¢‘æ–‡ä»¶');
                });
            } else {
                bgMusic.pause();
                musicBtn.textContent = 'ğŸ”‡';
            }
        }

        // ç”¨æˆ·é¦–æ¬¡äº¤äº’æ—¶å°è¯•æ’­æ”¾
        let hasInteracted = false;
        document.addEventListener('click', function() {
            if (!hasInteracted && bgMusic) {
                hasInteracted = true;
                bgMusic.play().then(() => {
                    musicBtn.textContent = 'ğŸ”Š';
                }).catch(() => {
                    // é™é»˜å¤„ç†
                });
            }
        });

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥çŠ¶æ€
        window.addEventListener('load', checkMountainComplete);
    </script>
</body>
</html>